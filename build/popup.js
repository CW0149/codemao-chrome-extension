(()=>{"use strict";const e=async()=>{const e=await(async()=>(await chrome.cookies.get({name:"yyb_vue_admin_template_token",url:"https://festival.codemao.cn/h5/yybAdmin/"}))?.value)();if(!e)return{loggedIn:!1};const n=await(e=>((e,n)=>fetch("https://festival.codemao.cn/yyb2019/index/info",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json, text/plain, */*",token:e}}).then((e=>e.json())))(e).then((e=>e?.info?.username??"")))(e);return n?{loggedIn:!0,token:e,teacherEmail:n}:{loggedIn:!1}},n=document.getElementById("openToolBtn"),t=async()=>{const e=await(async()=>(await chrome.cookies.get({name:"internal_account_token",url:"https://internal-account.codemao.cn/"}))?.value)();return{loggedIn:!!e,info:{token:e}}};n.addEventListener("click",(async()=>{const{festival:{loggedIn:n,info:a},internalAccount:{loggedIn:o,info:c}}=await(async()=>({festival:await(async()=>{const n=await e();return{loggedIn:n.loggedIn,info:{token:n.token,teacherEmail:n.teacherEmail}}})(),internalAccount:await t()}))();if(!await(async e=>chrome.runtime.sendMessage(e))({type:"handleLogin",message:{festivalLoggedIn:n,internalAccountLoggedIn:o}}))return;const{token:i,teacherEmail:s}=a;await(async(e,n,t)=>{const a=new URLSearchParams({token:e,teacher_email:n,internal_account_token:t});return chrome.tabs.create({url:`http://42.194.164.225/codemao-resitival-tool/?${a.toString()}`})})(i,s,c.token)}))})();